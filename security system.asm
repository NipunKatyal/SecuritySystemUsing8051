ORG 0000H
LJMP MAIN
ORG 0023H
LJMP SERIAL

MAIN:
MOV TMOD,#21H
MOV IE,#90H
MOV SCON,#50H
MOV R0,#04H
MOV DPTR,#4500H
MOV TH1,#0FDH
MOV P2,#00H
SETB P2.7
SETB TR1
L:
CJNE R0,#00H,H
MOV DPTR,#4500H
MOVX A,@DPTR
MOV R2,A
INC DPTR
MOVX A,@DPTR
MOV R3,A
INC DPTR
MOVX A,@DPTR
MOV R4,A
INC DPTR
MOVX A,@DPTR
MOV R5,A
CJNE R2,#31H,FAIL
CJNE R3,#32H,FAIL
CJNE R4,#33H,FAIL
CJNE R5,#34H,FAIL
CLR P2.7
SETB P2.0
HE:SJMP HE
FAIL: SETB P2.6
CLR P2.7
HF: SJMP HF
H:
SJMP L

SERIAL:
JB TI,TRANS
MOV A,SBUF
MOVX @DPTR,A
INC DPTR
DEC R0 
CLR RI
RETI
TRANS: CLR TI
RETI


END
